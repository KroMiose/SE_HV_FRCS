# 灰陨火控雷达系统
- 这是一套使用C#编写的游戏脚本程序，游戏名：太空工程师
- 该程序实现了基于游戏中多网格(飞船)分布下的一套协同打击系统，其中应用了PID算法于目标锁定，导弹制导程序使用了贝塞尔曲线跟踪目标
- PS1: 由于程序实现时SE官方尚未更新 WARFACE2 DLC ，当前最新版本可能有更好的追踪和打击方案
- PS2: 严格上讲，本仓库仅作为项目存档，不保证会继续更新，即使有也大概率会根据游戏最新版本的api进行重构
- 程序中使用了由MEA提供的MEA方块类和Ship类，此外开发过程中MEA的参考指南也提供了大量帮助，在此特别鸣谢
- MEA程序开发指南链接: https://www.kancloud.cn/kylilimin/mea-ship/734517

## 功能: 
  1. 目标锁定/追踪: 使用任意雷达进行目标寻找并锁定跟踪，目标丢失时记录目标最后出现的信息
  2. 自动发射功能: 开启后锁定目标后自动发射指定枚数导弹进行攻击
  3. 多网格信息共享: 所有追踪的敌人数据通过天线共享，每次扫描到敌人通过天线广播，导弹可以根据广播的目标id检查更新目标或者主动制导追踪目标
  4. 易用的LCD界面: LCD面板根据状态切换颜色
  5. 闲置雷达自动扫描敌人(待实现)
  6. 导弹安全距离: 导弹发射有安全范围，离开安全范围后装备弹头
  7. 打击通讯协作: 导弹发射后根据雷达广播寻找目标，找到目标后自主锁定，发送目标验证数据，雷达接收到目标验证数据后提示“已验证”，此时可自主脱锁

## 方块构造
- 固定雷达构造: 
    将子网格连接到一个水平方向和一个竖直方向的转子上，将转子关闭并将制动力矩设为0
    必备方块: 
        远程控制、陀螺仪、摄像头(数量与追踪效果相关)
        所有方块命名含[Radar-N](N为雷达组别)

- 探机构造(尚未编写专用程序，但主控主控程序同时包含探机程序的所需功能): 
    必备方块: 
        远程控制、陀螺仪、摄像头(数量与追踪效果相关)、推进器(六个方向)、天线
        所有方块命名含[Spy-N](N为雷达组别)

- 普通导弹构造: 
    使用一个合并块来连接导弹，称为分离合并块，命名含[Mis-N-Merge](N为导弹组别)，导弹建造投影仪命名含[Mis-N-Printer](N为导弹组别)
    + 必备方块: 
        远程控制、陀螺仪、与前进方向相同的推进器若干、合并块
        所有方块命名含[Mis]
    + 可选: 
        其他方向的推进器: 可以增强导弹机动性
        弹头: 可以增强导弹的破坏效果
        天线: 定位导弹位置
        可编程模块: 加载导弹脚本
        摄像头: 配合可编程模块实现导弹自主追踪
        氢气罐: 氢动力导弹需要
        所有方块命名含[Mis]

    + 发射方式：
        单发发射：从导弹列表中选择一枚进行发射
        满仓发射：同时发射所有导弹

    + 备注：
        导弹在接收到发射指令后起飞前往目标，路程中不断更新目的地信息，同时发送自己与目标的距离信息，第一次接近目标20s或者发射后180s后自毁

- LCD面板: 
    > 在LCD的名称中包含对应关键词(不包含引号)可显示对应信息
    
    + 面板: 雷达列表
        关键词: “LCD-RadarList”
        内容: 显示所有雷达状态信息
        ```
            更新时间: [距离上次扫描经过的时间]
            状态: [闲置中、锁定中、丢失目标]
            锁定目标类型: [友好、中立、敌对]
            锁定目标名称: [目标网格名称]
            目标距离: [与自身的距离]
        ```

    + 面板: 雷达详情
        关键词: “LCD-Radar-N”(N为雷达组别)
        内容: 显示当前雷达状态信息
        ```
            状态: [闲置中、锁定中、丢失目标]
            当前目标类型: [友好、中立、敌对]
            当前目标名称: [目标网格名称]
            锁定目标类型: [友好、中立、敌对]
            锁定目标名称: [目标网格名称]
            目标距离: [与自身的距离]
        ```

    + 面板: 通讯记录
        关键词: “LCD-Record”
        内容: 显示当前通讯信息
        ```
            时间: [接收时间]
            坐标: [x, y, z]
            指令: [Lock、Attack]
            其他信息: 备注说明
        ```

    + 面板: 探机列表
        关键词: “LCD-SpyList”
        内容: 显示所有探机状态信息
        ```
            名称: [探机网格名]
            距离: [与母舰的距离]
            通讯状态: [信号正常、失联]
            位置: [xyz三轴位置(通过天线传输自己坐标)]
            状态: [闲置中、锁定中、跟踪中、失去目标、丢失目标]
            锁定目标类型: [友好、中立、敌对]
            锁定目标名称: [目标网格名称]
            目标距离: [与自身的距离]
        ```

    + 面板: 目标列表
        关键词: “LCD-TargetList”
        内容: 
        ```
            目标类型: [友好、中立、敌对]
            目标名称: [目标名称]
            距离: [与追踪单位之间的距离]
            上次扫描时间: [最后一次扫描到的时间]
        ```

    + 面板: 导弹坞列表
        关键词: “LCD-MissileDoker”
        内容: 显示所有导弹坞状态信息
        ```
            状态: [准备中、就绪、正在发射]
            类型: [普通导弹、制导导弹、诱饵导弹]
        ```

    + 面板: 导弹列表
        关键词: “LCD-Missile”
        内容: 显示所有导弹状态信息
        ```
            状态: [发射中、巡航中、制导中]
            遥测状态: [正常、失联]
            类型: [普通导弹、制导导弹、诱饵导弹]
            目标: [目标名]
            距离: [与目标直接的距离]
            时间: [发射后的时间]
        ```

## 指令: 
  1. "Fire-Launch-N"(N为导弹数量): 向所有锁定目标分别发射N枚导弹(必须存在锁定的目标)
  2. "autoFireOn": 开启自动攻击；"autoFireOff": 关闭自动攻击
  3. "setAutoLaunch-N": 设置自动发射导弹数量()
  4. "spyReturn": 所有探机回到待机位置，进入伴飞状态

## 通讯指令(程序间通讯使用): 
  1. 雷达/探机: 
    "Radar-N-togLock"(N为雷达/探机组别): 指定组别 雷达/探机 锁定/解锁 目标
    "Radar-N-scanPos"(N为雷达/探机组别): 指定雷达扫描指定坐标并自动锁定敌人
    "Radar-N-launch-M"(N为雷达/探机组别): 向指定雷达锁定的目标发射M枚导弹

## 编程块配置: 
  1. 母舰: 
     搭载主要火控雷达系统程序x1
  2. 导弹: 
     搭载弹体程序 x 1
  3. 探机: 
     搭载探机程序 x 1